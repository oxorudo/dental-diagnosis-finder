{% load static %}
<html lang="ko">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
      {% block title %}치과 상병 코드 검색{% endblock %}
    </title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'styles.css' %}">
  </head>

  <body>

    <div class="container-fluid">
      <div class="row">
        <!-- 왼쪽 드롭다운 메뉴 -->
        <nav class="col-md-2 d-none d-md-block bg-light sidebar">
          <div class="position-sticky">
            <ul class="nav flex-column">
              <li class="nav-item">
                <a class="nav-link active" href="#">
                  치과 상병 코드 검색
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">
                  통계
                </a>
              </li>
              <!-- 추가 메뉴 항목들 -->
            </ul>
          </div>
        </nav>

        <!-- 메인 컨텐츠 영역 -->
        <main class="col-md-10 ms-sm-auto col-lg-10 px-md-4 main-content">
          <!-- 검색 영역 (6/1) -->
          <div class="search-area d-flex justify-content-center align-items-center">
            <div class="w-75">
              <input type="text" class="form-control" id="search-input" placeholder="상병 코드 또는 상병명을 입력하세요">
              <button class="btn btn-primary mt-2" id="search-button">검색</button>
            </div>
          </div>

          <div class="row">
            <!-- 결과 테이블 영역 (6/3) -->
            <div class="col-md-12 result-table">
              <div class="table-responsive">
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th>불완전 상병 코드</th>
                      <th>불완전 상병명</th>
                      <th>청구 카테고리</th>
                      <th>세부 청구 항목</th>
                    </tr>
                  </thead>
                  <tbody id="result-body">
                    <!-- 여기에 검색 결과가 동적으로 추가됩니다 -->
                  </tbody>
                </table>
              </div>
            </div>

            <!-- 상세 정보 영역 (6/2) -->
            <div class="col-md-12 detail-area mt-3">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title">상세 정보</h5>
                  <div id="detail-content">
                    <!-- 여기에 선택된 항목의 상세 정보가 표시됩니다 -->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // 샘플 데이터 (실제로는 서버에서 가져와야 합니다)
      const data = [
        {
          code: "K00.~",
          name: "치아 발육 및 맹출 장애",
          category: "",
          details: ""
        }, {
          code: "K00.0~",
          name: "무치증",
          category: "",
          details: "보통처치, 근관세척, 근관충전, 근관확대, 근관성형, 당일발수근충, 발수, 근관와동형성, 신경치료 상병명, 응급근관처치"
        }, {
          code: "K00.00",
          name: "부분무치증",
          category: "청구 기초 및 기본진료",
          details: "기본진료 종류 및 상병, 상세불명 vs 기타 명시된 상병명 차이, 치근단, 치근단 동시 촬영, 광중합형 복합레진 충전, 보통처치, 실란트, 즉일충전처치, 진정처치, 충전물 연마, 치면열구전색, 치수복조, 치은판 절제술"
        }
      ];

      document
        .getElementById('search-button')
        .addEventListener('click', function () {
          const searchTerm = document
            .getElementById('search-input')
            .value
            .toLowerCase();
          const resultBody = document.getElementById('result-body');
          resultBody.innerHTML = '';

          data.forEach(item => {
            if (item.code.toLowerCase().includes(searchTerm) || item.name.toLowerCase().includes(searchTerm)) {
              const row = resultBody.insertRow();
              row
                .insertCell(0)
                .textContent = item.code;
              row
                .insertCell(1)
                .textContent = item.name;
              row
                .insertCell(2)
                .textContent = item.category || '없음';
              row
                .insertCell(3)
                .textContent = item.details || '없음';
              row.addEventListener('click', () => showDetails(item));
            }
          });
        });

      function showDetails(item) {
        const detailContent = document.getElementById('detail-content');
        detailContent.innerHTML = `
                <p><strong>불완전 상병 코드:</strong> ${item.code}</p>
                <p><strong>불완전 상병명:</strong> ${item.name}</p>
                <p><strong>청구 카테고리:</strong> ${item.category || '없음'}</p>
                <p><strong>세부 청구 항목:</strong> ${item.details || '없음'}</p>
            `;
      }
    </script>

  </body>

</html>
