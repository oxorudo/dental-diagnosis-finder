{% load static %}

<link rel="stylesheet" href="{% static 'css/search_bar.css' %}">

<form method="GET" action="{% url 'search_view' %}" class="d-flex w-100">
    <div class="input-group">
        <input type="text" class="form-control me-2" name="q" id="search-input" placeholder="상병 코드 또는 상병명을 입력하세요" value="{{ query }}" autocomplete="off">
        <button type="button" id="clear-btn" class="btn" aria-label="검색어 삭제">
            <i class="fas fa-times"></i>
        </button>
        <button class="btn btn-primary search-btn" type="submit">검색</button>
    </div>
</form>

<script>
    const searchInput = document.getElementById('search-input');
    const clearBtn = document.getElementById('clear-btn');
    
    // 입력 값이 있을 때만 clear 버튼을 표시
    searchInput.addEventListener('input', function() {
        if (searchInput.value.trim() !== '') {
            clearBtn.style.display = 'block';  // 검색어가 있을 때 버튼 표시
        } else {
            clearBtn.style.display = 'none';   // 검색어가 없으면 버튼 숨김
        }
    });
    
    // clear 버튼 클릭 시 입력 필드 초기화 및 버튼 숨김
    clearBtn.addEventListener('click', function() {
        searchInput.value = '';                 // 검색어 지우기
        clearBtn.style.display = 'none';        // 버튼 숨기기
        searchInput.focus();                    // 검색창에 포커스 유지
    });
</script>
